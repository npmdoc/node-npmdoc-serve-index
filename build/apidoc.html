<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/expressjs/serve-index"

    >serve-index (v1.8.0)</a>
</h1>
<h4>Serve directory listings</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.serve-index">module serve-index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.serve-index.serve-index">
            function <span class="apidocSignatureSpan"></span>serve-index
            <span class="apidocSignatureSpan">(root, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.serve-index.html">
            function <span class="apidocSignatureSpan">serve-index.</span>html
            <span class="apidocSignatureSpan">(req, res, files, next, dir, showUp, icons, path, view, template, stylesheet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.serve-index.json">
            function <span class="apidocSignatureSpan">serve-index.</span>json
            <span class="apidocSignatureSpan">(req, res, files)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.serve-index.plain">
            function <span class="apidocSignatureSpan">serve-index.</span>plain
            <span class="apidocSignatureSpan">(req, res, files)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.serve-index" id="apidoc.module.serve-index">module serve-index</a></h1>


    <h2>
        <a href="#apidoc.element.serve-index.serve-index" id="apidoc.element.serve-index.serve-index">
        function <span class="apidocSignatureSpan"></span>serve-index
        <span class="apidocSignatureSpan">(root, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function serveIndex(root, options) {
  var opts = options || {};

  // root required
  if (!root) {
    throw new TypeError(&#x27;serveIndex() root path required&#x27;);
  }

  // resolve root to absolute and normalize
  var rootPath = normalize(resolve(root) + sep);

  var filter = opts.filter;
  var hidden = opts.hidden;
  var icons = opts.icons;
  var stylesheet = opts.stylesheet || defaultStylesheet;
  var template = opts.template || defaultTemplate;
  var view = opts.view || &#x27;tiles&#x27;;

  return function (req, res, next) {
    if (req.method !== &#x27;GET&#x27; &#x26;&#x26; req.method !== &#x27;HEAD&#x27;) {
      res.statusCode = &#x27;OPTIONS&#x27; === req.method ? 200 : 405;
      res.setHeader(&#x27;Allow&#x27;, &#x27;GET, HEAD, OPTIONS&#x27;);
      res.setHeader(&#x27;Content-Length&#x27;, &#x27;0&#x27;);
      res.end();
      return;
    }

    // parse URLs
    var url = parseUrl(req);
    var originalUrl = parseUrl.original(req);
    var dir = decodeURIComponent(url.pathname);
    var originalDir = decodeURIComponent(originalUrl.pathname);

    // join / normalize from root dir
    var path = normalize(join(rootPath, dir));

    // null byte(s), bad request
    if (~path.indexOf(&#x27;\0&#x27;)) return next(createError(400));

    // malicious path
    if ((path + sep).substr(0, rootPath.length) !== rootPath) {
      debug(&#x27;malicious path &#x22;%s&#x22;&#x27;, path);
      return next(createError(403));
    }

    // determine &#x22;..&#x22; display
    var showUp = normalize(resolve(path) + sep) !== rootPath;

    // check if we have a directory
    debug(&#x27;stat &#x22;%s&#x22;&#x27;, path);
    fs.stat(path, function(err, stat){
      if (err &#x26;&#x26; err.code === &#x27;ENOENT&#x27;) {
        return next();
      }

      if (err) {
        err.status = err.code === &#x27;ENAMETOOLONG&#x27;
          ? 414
          : 500;
        return next(err);
      }

      if (!stat.isDirectory()) return next();

      // fetch files
      debug(&#x27;readdir &#x22;%s&#x22;&#x27;, path);
      fs.readdir(path, function(err, files){
        if (err) return next(err);
        if (!hidden) files = removeHidden(files);
        if (filter) files = files.filter(function(filename, index, list) {
          return filter(filename, index, list, path);
        });
        files.sort();

        // content-negotiation
        var accept = accepts(req);
        var type = accept.type(mediaTypes);

        // not acceptable
        if (!type) return next(createError(406));
        serveIndex[mediaType[type]](req, res, files, next, originalDir, showUp, icons, path, view, template, stylesheet);
      });
    });
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.serve-index.html" id="apidoc.element.serve-index.html">
        function <span class="apidocSignatureSpan">serve-index.</span>html
        <span class="apidocSignatureSpan">(req, res, files, next, dir, showUp, icons, path, view, template, stylesheet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function _html(req, res, files, next, dir, showUp, icons, path, view, template, stylesheet) {
  var render = typeof template !== &#x27;function&#x27;
    ? createHtmlRender(template)
    : template

  if (showUp) {
    files.unshift(&#x27;..&#x27;);
  }

  // stat all files
  stat(path, files, function (err, stats) {
    if (err) return next(err);

    // combine the stats into the file list
    var fileList = files.map(function (file, i) {
      return { name: file, stat: stats[i] };
    });

    // sort file list
    fileList.sort(fileSort);

    // read stylesheet
    fs.readFile(stylesheet, &#x27;utf8&#x27;, function (err, style) {
      if (err) return next(err);

      // create locals for rendering
      var locals = {
        directory: dir,
        displayIcons: Boolean(icons),
        fileList: fileList,
        path: path,
        style: style,
        viewName: view
      };

      // render html
      render(locals, function (err, body) {
        if (err) return next(err);

        var buf = new Buffer(body, &#x27;utf8&#x27;);
        res.setHeader(&#x27;Content-Type&#x27;, &#x27;text/html; charset=utf-8&#x27;);
        res.setHeader(&#x27;Content-Length&#x27;, buf.length);
        res.end(buf);
      });
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.serve-index.json" id="apidoc.element.serve-index.json">
        function <span class="apidocSignatureSpan">serve-index.</span>json
        <span class="apidocSignatureSpan">(req, res, files)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function _json(req, res, files) {
  var body = JSON.stringify(files);
  var buf = new Buffer(body, &#x27;utf8&#x27;);

  res.setHeader(&#x27;Content-Type&#x27;, &#x27;application/json; charset=utf-8&#x27;);
  res.setHeader(&#x27;Content-Length&#x27;, buf.length);
  res.end(buf);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.serve-index.plain" id="apidoc.element.serve-index.plain">
        function <span class="apidocSignatureSpan">serve-index.</span>plain
        <span class="apidocSignatureSpan">(req, res, files)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function _plain(req, res, files) {
  var body = files.join(&#x27;\n&#x27;) + &#x27;\n&#x27;;
  var buf = new Buffer(body, &#x27;utf8&#x27;);

  res.setHeader(&#x27;Content-Type&#x27;, &#x27;text/plain; charset=utf-8&#x27;);
  res.setHeader(&#x27;Content-Length&#x27;, buf.length);
  res.end(buf);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
